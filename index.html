<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caleb Williams Season Tracker - aiomgwtfbbq.com</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* Dark background as a fallback */
            background-image: url('https://pbs.twimg.com/media/GW94-C9WIAAHKik?format=jpg&name=large');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        header h1, header p {
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.7);
        }
        .card {
            background-color: rgba(31, 41, 55, 0.85); /* #1F2937 at 85% opacity */
            border: 1px solid rgba(55, 65, 81, 0.7); /* #374151 with adjusted opacity */
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px); /* For Safari */
        }
        .stat-value {
            color: #FBBF24;
        }
        .progress-bar-bg {
            background-color: #374151;
        }
        .progress-bar-fill {
            background-image: linear-gradient(to right, #ef4444, #f97316, #eab308, #22c55e, #3b82f6, #6366f1, #8b5cf6);
        }
        .toggle-bg:checked {
            background-color: #FBBF24;
        }
        .toggle-dot {
            transition: transform 0.3s ease-in-out;
        }
        .toggle-bg:checked + .toggle-dot {
            transform: translateX(100%);
        }
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
            border-radius: 0.5rem;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #FBBF24;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        #aiResponse {
            white-space: pre-wrap;
            background-color: rgba(17, 24, 39, 0.8);
            border-radius: 0.5rem;
            padding: 1rem;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 p-4 sm:p-6 md:p-8">

    <div class="max-w-7xl mx-auto">
        
        <header class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-white">Caleb Williams Season Tracker</h1>
            <p class="text-lg text-gray-300 mt-2">aiomgwtfbbq.com</p>
        </header>

        <main class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            
            <!-- Left Column -->
            <div class="flex flex-col gap-8">
                <!-- Update Stats Card -->
                <div class="card rounded-lg p-6 shadow-lg">
                    <h2 class="text-2xl font-semibold mb-4 text-white">Update Stats</h2>
                    <div class="space-y-4">
                        <div>
                            <label for="gamesPlayed" class="block text-sm font-medium text-gray-300">Games Played</label>
                            <input type="number" id="gamesPlayed" value="4" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-yellow-500 focus:border-yellow-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="currentYards" class="block text-sm font-medium text-gray-300">Passing Yards</label>
                            <input type="number" id="currentYards" value="927" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-yellow-500 focus:border-yellow-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="currentTDs" class="block text-sm font-medium text-gray-300">Passing Touchdowns</label>
                            <input type="number" id="currentTDs" value="8" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-yellow-500 focus:border-yellow-500 sm:text-sm">
                        </div>
                        <button id="updateButton" class="w-full bg-yellow-500 hover:bg-yellow-600 text-gray-900 font-bold py-2 px-4 rounded-lg transition duration-300">Update Dashboard</button>
                    </div>
                     <p class="text-center text-xs text-gray-400 mt-4">
                        <a href="https://www.espn.com/nfl/player/stats/_/id/4431611/caleb-williams" target="_blank" rel="noopener noreferrer" class="hover:text-yellow-400 underline">Verify stats on ESPN</a>
                    </p>
                </div>

                <!-- Season Length Toggle Card -->
                <div class="card rounded-lg p-6 shadow-lg">
                    <h2 class="text-2xl font-semibold mb-4 text-white">Season Settings</h2>
                    <div class="flex items-center justify-center space-x-4">
                        <span class="font-medium text-gray-300">16 Games</span>
                        <label for="seasonToggle" class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="seasonToggle" class="sr-only peer toggle-bg">
                            <div class="w-11 h-6 bg-gray-600 rounded-full peer-checked:bg-yellow-500 transition-colors"></div>
                            <div class="absolute left-1 top-1 bg-white border-gray-300 border rounded-full h-4 w-4 transition-transform toggle-dot peer-checked:translate-x-full"></div>
                        </label>
                        <span class="font-medium text-gray-300">17 Games</span>
                    </div>
                </div>

                 <!-- Gemini AI Analysis Card -->
                <div id="gemini-card" class="card rounded-lg p-6 shadow-lg relative">
                    <h2 class="text-2xl font-semibold mb-4 text-white">Gemini AI Analysis</h2>
                    <p class="text-sm text-gray-400 mb-4">Get AI-powered insights on Caleb Williams' performance.</p>
                    <div class="space-y-3">
                        <button id="generateGameplan" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">Generate Weekly Gameplan</button>
                        <button id="generateReport" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 disabled:bg-gray-500 disabled:cursor-not-allowed" disabled>Generate Mid-Season Report</button>
                         <button id="analyzePastGame" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">Analyze Past Game</button>
                        <button id="generateHotTake" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">ðŸ”¥ Generate Hot Take</button>
                    </div>
                    <div id="aiResponseContainer" class="mt-4" style="display: none;">
                        <h3 id="aiResponseTitle" class="text-xl font-semibold text-yellow-400 mb-2"></h3>
                        <p id="aiResponse" class="text-gray-300 text-sm"></p>
                    </div>
                    <div id="loading" class="loading-overlay" style="display: none;">
                        <div class="loader"></div>
                    </div>
                </div>
            </div>

            <!-- Main Content Area -->
            <div class="lg:col-span-2 flex flex-col gap-8">
                <!-- Passing Yards Progress Card -->
                <div class="card rounded-lg p-6 shadow-lg">
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <h2 class="text-2xl font-semibold text-white">Passing Yards Progress</h2>
                            <p class="text-sm text-gray-400">Goal: <span id="yardGoalText">4,000</span> Yards</p>
                        </div>
                        <div class="text-right">
                            <span id="yardsPercentage" class="text-2xl font-bold text-green-400">0%</span>
                        </div>
                    </div>
                     <div class="mb-4">
                        <div class="w-full progress-bar-bg rounded-full h-4">
                            <div id="yardsProgressBar" class="progress-bar-fill h-4 rounded-full" style="width: 0%;"></div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 text-center">
                        <div>
                            <p class="text-sm text-gray-400">Current</p>
                            <p id="currentYardsText" class="text-3xl font-bold stat-value">0</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-400">Yards Remaining</p>
                            <p id="yardsRemaining" class="text-3xl font-bold text-white">4,000</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-400">Needed Per Game</p>
                            <p id="yardsPerGame" class="text-3xl font-bold text-white">235.3</p>
                        </div>
                    </div>
                    <div class="mt-6 h-64 sm:h-80">
                        <canvas id="yardsChart"></canvas>
                    </div>
                </div>

                <!-- Passing Touchdowns Progress Card -->
                <div class="card rounded-lg p-6 shadow-lg">
                     <div class="flex justify-between items-start mb-2">
                        <div>
                            <h2 class="text-2xl font-semibold text-white">Passing Touchdowns Progress</h2>
                            <p class="text-sm text-gray-400">Goal: 30 Touchdowns</p>
                        </div>
                         <div class="text-right">
                            <span id="tdPercentage" class="text-2xl font-bold text-green-400">0%</span>
                        </div>
                    </div>
                    <div class="mb-4">
                        <div class="w-full progress-bar-bg rounded-full h-4">
                            <div id="tdProgressBar" class="progress-bar-fill h-4 rounded-full" style="width: 0%;"></div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 text-center">
                        <div>
                            <p class="text-sm text-gray-400">Current</p>
                            <p id="currentTDsText" class="text-3xl font-bold stat-value">0</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-400">TDs Remaining</p>
                            <p id="tdsRemaining" class="text-3xl font-bold text-white">30</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-400">Needed Per Game</p>
                            <p id="tdsPerGame" class="text-3xl font-bold text-white">1.8</p>
                        </div>
                    </div>
                     <div class="mt-6 h-64 sm:h-80">
                        <canvas id="tdsChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Weekly Highlights - Full Width -->
            <div class="md:col-span-2 lg:col-span-3 card rounded-lg p-6 shadow-lg">
                <h2 class="text-2xl font-semibold mb-4 text-white">Weekly Highlights</h2>
                <div id="weeklyHighlights" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                    <!-- Game week cards will be injected here -->
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- CONFIG & STATE ---
        const YARDS_GOAL = 4000;
        const TDS_GOAL = 30;
        let seasonLength = 17;
        let yardsChart, tdsChart;

        const gameSchedule = [
            { week: 1, title: 'Week 1 vs MIN', opponent: 'Minnesota Vikings', link: 'https://www.youtube.com/watch?v=example1' },
            { week: 2, title: 'Week 2 at DET', opponent: 'Detroit Lions', link: 'https://www.youtube.com/watch?v=example2' },
            { week: 3, title: 'Week 3 vs DAL', opponent: 'Dallas Cowboys', link: 'https://www.youtube.com/watch?v=example3' },
            { week: 4, title: 'Week 4 at LV', opponent: 'Las Vegas Raiders', link: 'https://www.youtube.com/watch?v=example4' },
            { week: 5, title: 'Week 5 - BYE', opponent: 'BYE WEEK', link: '#' },
            { week: 6, title: 'Week 6 at WAS', opponent: 'Washington Commanders', link: '#' },
            { week: 7, title: 'Week 7 vs NO', opponent: 'New Orleans Saints', link: '#' },
            { week: 8, title: 'Week 8 at BAL', opponent: 'Baltimore Ravens', link: '#' },
            { week: 9, title: 'Week 9 at CIN', opponent: 'Cincinnati Bengals', link: '#' },
            { week: 10, title: 'Week 10 vs NYG', opponent: 'New York Giants', link: '#' },
            { week: 11, title: 'Week 11 at MIN', opponent: 'Minnesota Vikings', link: '#' },
            { week: 12, title: 'Week 12 vs PIT', opponent: 'Pittsburgh Steelers', link: '#' },
            { week: 13, title: 'Week 13 at PHI', opponent: 'Philadelphia Eagles', link: '#' },
            { week: 14, title: 'Week 14 at GB', opponent: 'Green Bay Packers', link: '#' },
            { week: 15, title: 'Week 15 vs CLE', opponent: 'Cleveland Browns', link: '#' },
            { week: 16, title: 'Week 16 vs GB', opponent: 'Green Bay Packers', link: '#' },
            { week: 17, title: 'Week 17 at SF', opponent: 'San Francisco 49ers', link: '#' },
            { week: 18, title: 'Week 18 vs DET', opponent: 'Detroit Lions', link: '#' },
        ];
        
        // --- DOM ELEMENTS ---
        const gamesPlayedInput = document.getElementById('gamesPlayed');
        const currentYardsInput = document.getElementById('currentYards');
        const currentTDsInput = document.getElementById('currentTDs');
        const updateButton = document.getElementById('updateButton');
        const seasonToggle = document.getElementById('seasonToggle');

        // --- GEMINI API ELEMENTS ---
        const generateGameplanBtn = document.getElementById('generateGameplan');
        const generateReportBtn = document.getElementById('generateReport');
        const analyzePastGameBtn = document.getElementById('analyzePastGame');
        const generateHotTakeBtn = document.getElementById('generateHotTake');
        const aiResponseContainer = document.getElementById('aiResponseContainer');
        const aiResponseTitle = document.getElementById('aiResponseTitle');
        const aiResponseEl = document.getElementById('aiResponse');
        const loadingEl = document.getElementById('loading');
        
        // --- UTILITY FUNCTIONS ---
        const formatNumber = (num) => new Intl.NumberFormat('en-US').format(num);

        // --- GEMINI API CALL ---
        async function callGemini(prompt, systemPrompt = "") {
            loadingEl.style.display = 'flex';
            aiResponseContainer.style.display = 'none';
            try {
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                
                const payload = {
                    contents: [{ parts: [{ text: prompt }] }],
                    tools: [{ "google_search": {} }],
                };

                if (systemPrompt) {
                     payload.systemInstruction = { parts: [{ text: systemPrompt }] };
                }

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API call failed with status: ${response.status}`);
                }

                const result = await response.json();
                return result.candidates?.[0]?.content?.parts?.[0]?.text || "No response generated.";
            } catch (error) {
                console.error("Gemini API call error:", error);
                return `Error: Could not retrieve analysis. ${error.message}`;
            } finally {
                loadingEl.style.display = 'none';
            }
        }

        // --- CHARTING ---
        function createOrUpdateChart(chartInstance, canvasId, labels, data, colors, goal) {
            if (chartInstance) {
                chartInstance.destroy();
            }
            
            const ctx = document.getElementById(canvasId).getContext('2d');
            
            const chartData = {
                labels: labels,
                datasets: [{
                    label: 'Stats',
                    data: data,
                    backgroundColor: colors,
                    borderColor: colors.map(color => color.replace('0.6', '1')),
                    borderWidth: 1,
                }]
            };

            const chartOptions = {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        beginAtZero: true,
                        max: goal * 1.2, // Give some headroom
                        ticks: { color: '#9CA3AF' },
                        grid: { color: '#374151' }
                    },
                    y: {
                        ticks: { color: '#9CA3AF' },
                        grid: { color: '#374151' }
                    }
                },
                plugins: {
                    legend: { display: false },
                     datalabels: {
                        anchor: 'end',
                        align: 'end',
                        color: '#67e8f9', // Chicago Blue
                        font: {
                            weight: 'bold',
                            size: 12,
                        },
                        formatter: (value) => formatNumber(Math.round(value)),
                    }
                }
            };

            return new Chart(ctx, {
                type: 'bar',
                data: chartData,
                options: chartOptions,
                plugins: [ChartDataLabels]
            });
        }

        // --- UI UPDATE & CALCULATIONS ---
        function updateDashboard() {
            const gamesPlayed = parseInt(gamesPlayedInput.value) || 0;
            const currentYards = parseInt(currentYardsInput.value) || 0;
            const currentTDs = parseInt(currentTDsInput.value) || 0;

            const gamesRemaining = Math.max(0, seasonLength - gamesPlayed);
            
            // --- Yards Calculations ---
            const yardsRemaining = Math.max(0, YARDS_GOAL - currentYards);
            const yardsPerGameNeeded = gamesRemaining > 0 ? (yardsRemaining / gamesRemaining) : 0;
            const projectedYards = gamesPlayed > 0 ? (currentYards / gamesPlayed) * seasonLength : 0;
            const yardsPercentage = (currentYards / YARDS_GOAL) * 100;

            // --- TDs Calculations ---
            const tdsRemaining = Math.max(0, TDS_GOAL - currentTDs);
            const tdsPerGameNeeded = gamesRemaining > 0 ? (tdsRemaining / gamesRemaining) : 0;
            const projectedTDs = gamesPlayed > 0 ? (currentTDs / gamesPlayed) * seasonLength : 0;
            const tdPercentage = (currentTDs / TDS_GOAL) * 100;

            // --- Update UI Text & Progress Bars ---
            document.getElementById('currentYardsText').textContent = formatNumber(currentYards);
            document.getElementById('yardsRemaining').textContent = formatNumber(yardsRemaining);
            document.getElementById('yardsPerGame').textContent = yardsPerGameNeeded.toFixed(1);
            document.getElementById('yardsPercentage').textContent = `${yardsPercentage.toFixed(1)}%`;
            document.getElementById('yardsProgressBar').style.width = `${Math.min(100, yardsPercentage)}%`;
            
            document.getElementById('currentTDsText').textContent = currentTDs;
            document.getElementById('tdsRemaining').textContent = tdsRemaining;
            document.getElementById('tdsPerGame').textContent = tdsPerGameNeeded.toFixed(1);
            document.getElementById('tdPercentage').textContent = `${tdPercentage.toFixed(1)}%`;
            document.getElementById('tdProgressBar').style.width = `${Math.min(100, tdPercentage)}%`;

            document.getElementById('yardGoalText').textContent = formatNumber(YARDS_GOAL);

            // --- Update Charts ---
            yardsChart = createOrUpdateChart(
                yardsChart, 
                'yardsChart',
                ['Current', 'Goal', 'Projected'], 
                [currentYards, YARDS_GOAL, projectedYards],
                ['rgba(0, 20, 40, 0.7)', 'rgba(200, 56, 3, 0.7)', 'rgba(0, 20, 40, 0.7)'],
                YARDS_GOAL
            );

            tdsChart = createOrUpdateChart(
                tdsChart,
                'tdsChart',
                ['Current', 'Goal', 'Projected'], 
                [currentTDs, TDS_GOAL, projectedTDs],
                ['rgba(255, 107, 0, 0.7)', 'rgba(0, 83, 155, 0.7)', 'rgba(255, 107, 0, 0.7)'],
                TDS_GOAL
            );

            // Enable/disable mid-season report
            generateReportBtn.disabled = gamesPlayed < 8;
            
            renderSchedule();
        }

        function renderSchedule() {
            const scheduleContainer = document.getElementById('weeklyHighlights');
            const gamesPlayed = parseInt(gamesPlayedInput.value) || 0;
            scheduleContainer.innerHTML = ''; // Clear existing schedule

            gameSchedule.forEach(game => {
                const card = document.createElement('div');
                card.className = 'bg-gray-800 p-3 rounded-lg flex flex-col justify-between';
                
                const status = game.week === 5 ? '' : (game.week <= gamesPlayed ? '' : '<span class="text-xs text-gray-400">Upcoming</span>');
                
                let linksHTML = '';
                if (game.week <= gamesPlayed && game.week !== 5) { // Week 5 is BYE
                     linksHTML = `<a href="${game.link}" target="_blank" rel="noopener noreferrer" class="text-xs text-yellow-400 hover:text-yellow-300 transition-colors">View Highlights Â»</a>`;
                }

                card.innerHTML = `
                    <div>
                        <h3 class="font-semibold text-white">${game.title}</h3>
                        <p class="text-sm text-gray-300">${game.opponent}</p>
                    </div>
                    <div class="mt-2 text-right">
                        ${status || linksHTML}
                    </div>
                `;
                scheduleContainer.appendChild(card);
            });
        }
        

        // --- EVENT LISTENERS ---
        updateButton.addEventListener('click', updateDashboard);
        
        seasonToggle.addEventListener('change', () => {
            seasonLength = seasonToggle.checked ? 17 : 16;
            document.querySelector('.toggle-dot').classList.toggle('bg-yellow-200');
            updateDashboard();
        });

        generateGameplanBtn.addEventListener('click', async () => {
            const gamesPlayed = parseInt(gamesPlayedInput.value);
            if (gamesPlayed >= 18) {
                aiResponseTitle.innerText = "Season Over";
                aiResponseEl.innerText = "The regular season has concluded.";
                aiResponseContainer.style.display = 'block';
                return;
            }
            const nextGameIndex = gameSchedule.findIndex(g => g.week > gamesPlayed && g.week !== 5);
            const nextGame = gameSchedule[nextGameIndex];
            const systemPrompt = `You are a world-class NFL offensive coordinator. Provide a concise, single-paragraph gameplan for your quarterback, Caleb Williams. Focus on exploiting the upcoming opponent's weaknesses.`;
            const prompt = `Generate a gameplan for Caleb Williams for the upcoming game in Week ${nextGame.week} against the ${nextGame.opponent}. His current stats are: ${currentYardsInput.value} passing yards and ${currentTDsInput.value} TDs through ${gamesPlayed} games.`;
            const response = await callGemini(prompt, systemPrompt);
            aiResponseTitle.innerText = `Gameplan: Week ${nextGame.week} vs ${nextGame.opponent}`;
            aiResponseEl.innerText = response;
            aiResponseContainer.style.display = 'block';
        });

        generateReportBtn.addEventListener('click', async () => {
            const systemPrompt = "You are a lead NFL analyst for ESPN. Provide a concise, well-structured mid-season report for Caleb Williams. Analyze his performance, progress towards his goals, and areas for improvement.";
            const prompt = `Generate a mid-season report for Caleb Williams. He has played ${gamesPlayedInput.value} games in a ${seasonLength}-game season. His current stats are ${currentYardsInput.value} passing yards and ${currentTDsInput.value} passing touchdowns. His goals are ${YARDS_GOAL} yards and ${TDS_GOAL} TDs.`;
            const response = await callGemini(prompt, systemPrompt);
            aiResponseTitle.innerText = `Mid-Season Report`;
            aiResponseEl.innerText = response;
            aiResponseContainer.style.display = 'block';
        });
        
        analyzePastGameBtn.addEventListener('click', async () => {
            const gamesPlayed = parseInt(gamesPlayedInput.value) || 0;
            const pastGames = gameSchedule.filter(g => g.week <= gamesPlayed && g.week !== 5);
            
            if (pastGames.length === 0) {
                 alert("No past games to analyze yet.");
                 return;
            }

            const weekToAnalyze = prompt(`Which week would you like to analyze? (1-${gamesPlayed})`);
            const weekNum = parseInt(weekToAnalyze);

            if (!weekNum || weekNum < 1 || weekNum > gamesPlayed) {
                alert("Invalid week selected.");
                return;
            }

            const game = gameSchedule.find(g => g.week === weekNum);
            if (!game) {
                 alert("Game not found for that week.");
                 return;
            }

            const systemPrompt = "You are a sharp, insightful NFL analyst. Provide a short, one-paragraph summary of Caleb Williams' performance in the specified game based on the opponent and context provided. Use Google Search to find relevant stats or news from that game if possible.";
            const prompt = `Provide a post-game analysis for Caleb Williams' performance in Week ${weekNum} against the ${game.opponent}.`;
            
            const response = await callGemini(prompt, systemPrompt);
            aiResponseTitle.innerText = `Analysis: Week ${weekNum} vs ${game.opponent}`;
            aiResponseEl.innerText = response;
            aiResponseContainer.style.display = 'block';
        });

        generateHotTakeBtn.addEventListener('click', async () => {
            const systemPrompt = "You are a fiery, opinionated sports radio host known for your bold, controversial takes. Do not be boring. Create a 'hot take' about Caleb Williams.";
            const prompt = `Generate a 'hot take' about Caleb Williams' season so far. He has ${currentYardsInput.value} yards and ${currentTDsInput.value} TDs in ${gamesPlayedInput.value} games. Be provocative.`;
            
            const response = await callGemini(prompt, systemPrompt);
            aiResponseTitle.innerText = `ðŸ”¥ Hot Take! ðŸ”¥`;
            aiResponseEl.innerText = response;
            aiResponseContainer.style.display = 'block';
        });


        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            seasonToggle.checked = true; // Default to 17 games
            updateDashboard();
        });
    </script>

</body>
</html>

